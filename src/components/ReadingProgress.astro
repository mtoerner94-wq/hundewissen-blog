---
// ReadingProgress.astro — Dünner Lesefortschritts-Balken am oberen Bildschirmrand
---

<div
  id="reading-progress"
  class="fixed top-0 left-0 h-[3px] bg-gradient-to-r from-[var(--color-primary)] to-[var(--color-primary-dark)] z-[60] transition-[width] duration-150 ease-out"
  style="width: 0%"
  aria-hidden="true"
></div>

<script>
  const bar = document.getElementById('reading-progress');
  if (bar) {
    const update = () => {
      const scrollTop = window.scrollY;
      const docHeight = document.documentElement.scrollHeight - window.innerHeight;
      const progress = docHeight > 0 ? Math.min((scrollTop / docHeight) * 100, 100) : 0;
      bar.style.width = `${progress}%`;
    };

    let ticking = false;
    window.addEventListener('scroll', () => {
      if (!ticking) {
        requestAnimationFrame(() => {
          update();
          ticking = false;
        });
        ticking = true;
      }
    }, { passive: true });

    update();
  }
</script>
